{"ast":null,"code":"import CryptoJS from 'crypto-js';\n\n// Generate a hash of the document content\nexport const hashContent = content => {\n  return CryptoJS.SHA256(content).toString();\n};\n\n// Create a signature for the document using a simple signing method\nexport const signDocument = documentData => {\n  const dataString = JSON.stringify({\n    content: documentData.content,\n    keystrokes: documentData.keystrokes,\n    versions: documentData.versions,\n    typingStats: documentData.typingStats,\n    pasteEvents: documentData.pasteEvents || [],\n    timestamp: documentData.timestamp\n  });\n  return CryptoJS.SHA256(dataString).toString();\n};\n\n// Verify the signature matches the document data\nexport const verifySignature = certificate => {\n  var _certificate$verifica;\n  const expectedSignature = signDocument({\n    content: certificate.document.content,\n    keystrokes: certificate.document.keystrokes,\n    versions: certificate.document.versions,\n    typingStats: certificate.document.typingStats,\n    timestamp: certificate.timestamp\n  });\n\n  // Check both possible signature locations for backwards compatibility\n  const storedSignature = ((_certificate$verifica = certificate.verification) === null || _certificate$verifica === void 0 ? void 0 : _certificate$verifica.signature) || certificate.signature;\n  return expectedSignature === storedSignature;\n};\n\n// Generate a unique certificate ID\nexport const generateCertificateId = () => {\n  return 'cert_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);\n};","map":{"version":3,"names":["CryptoJS","hashContent","content","SHA256","toString","signDocument","documentData","dataString","JSON","stringify","keystrokes","versions","typingStats","pasteEvents","timestamp","verifySignature","certificate","_certificate$verifica","expectedSignature","document","storedSignature","verification","signature","generateCertificateId","Date","now","Math","random","substr"],"sources":["/Users/van/Desktop/moc/frontend/src/utils/crypto.js"],"sourcesContent":["import CryptoJS from 'crypto-js';\n\n// Generate a hash of the document content\nexport const hashContent = (content) => {\n  return CryptoJS.SHA256(content).toString();\n};\n\n// Create a signature for the document using a simple signing method\nexport const signDocument = (documentData) => {\n  const dataString = JSON.stringify({\n    content: documentData.content,\n    keystrokes: documentData.keystrokes,\n    versions: documentData.versions,\n    typingStats: documentData.typingStats,\n    pasteEvents: documentData.pasteEvents || [],\n    timestamp: documentData.timestamp,\n  });\n\n  return CryptoJS.SHA256(dataString).toString();\n};\n\n// Verify the signature matches the document data\nexport const verifySignature = (certificate) => {\n  const expectedSignature = signDocument({\n    content: certificate.document.content,\n    keystrokes: certificate.document.keystrokes,\n    versions: certificate.document.versions,\n    typingStats: certificate.document.typingStats,\n    timestamp: certificate.timestamp,\n  });\n\n  // Check both possible signature locations for backwards compatibility\n  const storedSignature = certificate.verification?.signature || certificate.signature;\n\n  return expectedSignature === storedSignature;\n};\n\n// Generate a unique certificate ID\nexport const generateCertificateId = () => {\n  return 'cert_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);\n};\n"],"mappings":"AAAA,OAAOA,QAAQ,MAAM,WAAW;;AAEhC;AACA,OAAO,MAAMC,WAAW,GAAIC,OAAO,IAAK;EACtC,OAAOF,QAAQ,CAACG,MAAM,CAACD,OAAO,CAAC,CAACE,QAAQ,CAAC,CAAC;AAC5C,CAAC;;AAED;AACA,OAAO,MAAMC,YAAY,GAAIC,YAAY,IAAK;EAC5C,MAAMC,UAAU,GAAGC,IAAI,CAACC,SAAS,CAAC;IAChCP,OAAO,EAAEI,YAAY,CAACJ,OAAO;IAC7BQ,UAAU,EAAEJ,YAAY,CAACI,UAAU;IACnCC,QAAQ,EAAEL,YAAY,CAACK,QAAQ;IAC/BC,WAAW,EAAEN,YAAY,CAACM,WAAW;IACrCC,WAAW,EAAEP,YAAY,CAACO,WAAW,IAAI,EAAE;IAC3CC,SAAS,EAAER,YAAY,CAACQ;EAC1B,CAAC,CAAC;EAEF,OAAOd,QAAQ,CAACG,MAAM,CAACI,UAAU,CAAC,CAACH,QAAQ,CAAC,CAAC;AAC/C,CAAC;;AAED;AACA,OAAO,MAAMW,eAAe,GAAIC,WAAW,IAAK;EAAA,IAAAC,qBAAA;EAC9C,MAAMC,iBAAiB,GAAGb,YAAY,CAAC;IACrCH,OAAO,EAAEc,WAAW,CAACG,QAAQ,CAACjB,OAAO;IACrCQ,UAAU,EAAEM,WAAW,CAACG,QAAQ,CAACT,UAAU;IAC3CC,QAAQ,EAAEK,WAAW,CAACG,QAAQ,CAACR,QAAQ;IACvCC,WAAW,EAAEI,WAAW,CAACG,QAAQ,CAACP,WAAW;IAC7CE,SAAS,EAAEE,WAAW,CAACF;EACzB,CAAC,CAAC;;EAEF;EACA,MAAMM,eAAe,GAAG,EAAAH,qBAAA,GAAAD,WAAW,CAACK,YAAY,cAAAJ,qBAAA,uBAAxBA,qBAAA,CAA0BK,SAAS,KAAIN,WAAW,CAACM,SAAS;EAEpF,OAAOJ,iBAAiB,KAAKE,eAAe;AAC9C,CAAC;;AAED;AACA,OAAO,MAAMG,qBAAqB,GAAGA,CAAA,KAAM;EACzC,OAAO,OAAO,GAAGC,IAAI,CAACC,GAAG,CAAC,CAAC,GAAG,GAAG,GAAGC,IAAI,CAACC,MAAM,CAAC,CAAC,CAACvB,QAAQ,CAAC,EAAE,CAAC,CAACwB,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC;AAC7E,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}